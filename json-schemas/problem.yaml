$schema: http://json-schema.org/draft-07/schema#
type: object
properties:
  $schema:
    type: string
    format: uri
    const: https://www.sift.net/hddl/draft/2023-08-01/problem
  name:
    type: string
  domain:
    type: string
  objects:
    $ref: "#/$defs/typelist"
  goal:
    $ref: "#/$defs/goal"
  requirements:
    type: array
    items:
      type: string
  init:
    type: array
    items:
      $ref: "#/$defs/goal"
  htn:
    $ref: "#/$defs/problemHTN"
required:
  - $schema
  - name
  - init
  - htn

$defs:
  typelist:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
        type:
          type: string
      required: name
    title: Typed list
    description: >
      A list of objects, each of which associates a name with
      a type. Typing is optional in PDDL/HDDL, so the type
      property is optional.        
  atomicTerm:
    type: object
    properties:
      predicate:
        type: string
      args:
        type: array
        items:
          type: string
    required:
      - predicate
      - args
  goal:
    oneOf:
      - $ref: "#/$defs/atomicTerm"
      - null
      - $ref: "#/$defs/negatedGoal"
      - $ref: "#/$defs/naryOpGoal"
      - $ref: "#/$defs/binaryOpGoal"
      - $ref: "#/$defs/quantifiedGoal"
  negatedGoal:
    type: object
    properties:
      op:
        type: string
        enum:
          - not
      operand:
        $ref: "#/$defs/goal"
  binaryOpGoal:
    type: object
    properties:
      op:
        type: string
        enum:
          - imply
      operand1:
        $ref: "#/$defs/goal"
      operand2:
        $ref: "#/$defs/goal"
    required: [op, operand1, operand2]
  naryOpGoal:
    type: object
    properties:
      op:
        type: string
        enum:
          - and
          - or
      operands:
        type: array
        items:
          $ref: "#/$defs/goal"
    required: [op, operands]
